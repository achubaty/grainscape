<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modelling, visualization and analysis with the `grainscape` package • grainscape</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modelling, visualization and analysis with the `grainscape` package">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-SBRW4YWBD0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SBRW4YWBD0');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">grainscape</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/grainscape_vignette.html">Modelling, visualization and analysis with the `grainscape` package</a></li>
    <li><a class="dropdown-item" href="../articles/MPG_algorithm.html">Calculating the minimum planar graph and generating Voronoi tessellations</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/achubaty/grainscape/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Modelling, visualization and analysis with the `grainscape` package</h1>
                        <h4 data-toc-skip class="author">Paul Galpern<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Department of Biological Sciences, University of
Calgary, AB, Canada&lt;/p&gt;"><sup>1</sup></a>
</h4>
                        <h4 data-toc-skip class="author">Alex M.
Chubaty<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;FOR-CAST Research &amp;amp; Analytics, Calgary, AB, Canada&lt;/p&gt;"><sup>2</sup></a>
</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/achubaty/grainscape/blob/main/vignettes/grainscape_vignette.Rmd" class="external-link"><code>vignettes/grainscape_vignette.Rmd</code></a></small>
      <div class="d-none name"><code>grainscape_vignette.Rmd</code></div>
    </div>

    
    
<!-- be sure to use `tools::compactPDF("vignettes", qpdf = "/usr/bin/qpdf", gs_quality = "ebook")` to compact this vignette -->
<div style="page-break-after: always;"></div>
<div class="section level2">
<h2 id="visual-table-of-contents">Visual table of contents<a class="anchor" aria-label="anchor" href="#visual-table-of-contents"></a>
</h2>
<div class="float">
<img src="figures%2FpartA.png" style="width:90.0%" alt="Landscape network modelling with grainscape. Numerals refer to figures."><div class="figcaption">Landscape network modelling with
<code>grainscape</code>. Numerals refer to figures.</div>
</div>
<div style="page-break-after: always;"></div>
<div class="float">
<img src="figures%2FpartB.png" style="width:90.0%" alt="Scaling of landscape networks with grainscape. Numerals refer to figures."><div class="figcaption">Scaling of landscape networks with
<code>grainscape</code>. Numerals refer to figures.</div>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>grainscape</code> package enables a range of analyses
within R that have applications across the disciplines of ecology,
conservation biology and geography. For example, networks extracted by
<code>grainscape</code> can be used to model habitat connectivity or
evaluate protected area network resilience. These networks can be
modelled, visualized and analyzed at multiple spatial scales. A more
general contribution is the ability to extract Voronoi tessellations on
a continuous resistance surface. This has applications in spatial
analysis, for example to model service areas where travel times or the
cost of movement vary continuously across space.</p>
<p>The inspiration for the <code>grainscape</code> package is the
analysis of landscape connectivity. The approach comes from the
patch-based landscape graphs tradition <span class="citation">(Urban and
Keitt 2001; Fall et al. 2007; Galpern, Manseau, and Fall 2011)</span>
where a mathematical graph or network is used to represent the
relationships among habitat patches. In <code>grainscape</code> these
could equally be protected areas where connectivity for terrestrial
ecological processes is of interest, such as ranging behaviour or plant
and animal dispersal.</p>
<p>There are two types of models produced by <code>grainscape</code>.
The first, a minimum planar graph <span class="citation">(Fall et al.
2007)</span> is an efficient approximation of the potential for
connectivity among a set of focal two dimensional nodes. In landscape
connectivity modelling these nodes might be habitat patches or protected
areas.</p>
<p>The second model type is the grain of connectivity, which is based on
the minimum planar graph, but extends it in a way that may be useful for
scaling <span class="citation">(Galpern, Manseau, and Wilson 2012;
Galpern and Manseau 2013a, 2013b)</span>. Again, using landscape
connectivity as an example, these grains can be used for sensitivity
analyses of protected area connectivity, or to model highly mobile
terrestrial animals, such as ungulates and carnivores, where the habitat
patch may be not be a discrete and definable feature but is rather
defined probabilistically. The model achieves this by using the
complement of the minimum planar graph, a Voronoi tessellation of the
map, and modelling the relationships among polygons in a Voronoi
tessellation rather than discrete patches. This approach has been shown
to improve the ability to model movements of highly-mobile organisms
<span class="citation">(Galpern, Manseau, and Wilson 2012)</span>. For
example, grains of connectivity provides continuous coverage of the
entire landscape surface in a way that a typical patch-based network
does not. It also permits the examination of connectivity at multiple
scales, which can accommodate uncertainty in how species may perceive
landscape features <span class="citation">(Galpern and Manseau 2013a,
2013b)</span>.</p>
<p>The <code>grainscape</code> package provides functions to extract the
minimum planar graph and create two types of grains of connectivity:
patch and lattice forms. This reference begins by introducing these two
model types, and concludes by demonstrating a variety of
<code>grainscape</code> models, visualizations, and analyses using a
consistent visual style. Code and commentary are included throughout.
All analyses are reproducible with data distributed with this
package.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2">
<h2 id="modelling-with-grainscape">Modelling with <code>grainscape</code><a class="anchor" aria-label="anchor" href="#modelling-with-grainscape"></a>
</h2>
<p>In this section we demonstrate how to prepare rasters for modelling
with <code>grainscape</code>. Data provided with the package are used as
examples. The input to <code>grainscape</code> is a resistance surface,
and optionally a second raster describing the focal regions on a raster
which will serve as nodes in a network. The resistance surface may
represent the resistance to the flow of some ecological process of
interest, and the nodes, focal regions where this process has an origin.
A typical application is to model connectivity of landscapes for
dispersal of terrestrial animals. Here, the resistance surface models
the costs to movement, and the nodes habitat from which animals may
disperse. Many other applications of nodes and resistance surfaces are
equally valid and could represent both ecological and non-ecological
processes.</p>
<p>Inputs to <code>grainscape</code> are typically raster images.
Rasters may represent a geographical region, and ideally have a
projected coordinate system. This raster must contain cells with
<code>value &gt;= 1</code>, where values are real or integers. If data
are missing, cells must have <code>value == NA</code> (<em>e.g</em>,
commonly in the boundary cells of an irregularly shaped region of
interest).</p>
<p>The following are key packages required to complete analyses with
<code>grainscape</code>. The <code>igraph</code> package provides
network analytical functions, while <code>raster</code> provides the the
data structure and raster analytical functions upon which
<code>grainscape</code> depends to manage data. Finally model and
analytical products are compatible with visualizing using the popular
<code>ggplot2</code> idiom.</p>
<div class="section level3">
<h3 id="model-1-the-minimum-planar-graph">Model 1: The minimum planar graph<a class="anchor" aria-label="anchor" href="#model-1-the-minimum-planar-graph"></a>
</h3>
<p>The minimum planar graph (hereafter MPG) is a spatial representation
of a graph or a network that provides an efficient approximation of all
possible pairwise connections between graph nodes <span class="citation">(Fall et al. 2007)</span>. In graph-based landscape
connectivity analyses, graph nodes have typically been patches of
habitat that are demonstrably important for the species in question
<span class="citation">(Fall et al. 2007)</span>. In the following
example we will continue the habitat connectivity modelling objective
for clarity, but emphasize that this is not the only task to which these
methods can be applied.</p>
<p>An MPG representing habitat connectivity has links that model the
possibility for organism movement and dispersal between
spatially-adjacent habitat patches. In some cases spatially-adjacent
patches may not be linked, if the shortest connection between them can
be made through a third patch. In practice, this property means that the
MPG can be used to make a simple and easily visualized picture of how a
set of habitat patches is connected. The alternative, the complete
graph, can quickly become challenging to interpret because these may
contain a dense set of graph links making the pattern difficult to
discern. A second advantage of the MPG is the much reduced set of graph
links; this can be valuable where computational efficiency is important,
and essential where the number of habitat patches being modelled numbers
in the thousands.</p>
<p>However, there are some types of connectivity analyses where the MPG
approximation of the complete graph is not appropriate. For example,
assessing community structure within a landscape patch network
(<em>i.e.</em>, finding sets of patches that are densely connected) is
not possible as redundant connections have been removed intentionally.
Equally, the MPG is a poor choice for prioritizing the influence of a
patch for connectivity, the objective in a number of landscape graph
studies <span class="citation">(<em>e.g.</em>, Pascual-Hortal and Saura
2006)</span>. Please see <span class="citation">Galpern, Manseau, and
Fall (2011)</span> for further discussion of these limitations and of
the MPG.</p>
<div style="page-break-after: always;"></div>
<div class="section level4">
<h4 id="step-1-preparing-the-resistance-surface">Step 1: Preparing the resistance surface<a class="anchor" aria-label="anchor" href="#step-1-preparing-the-resistance-surface"></a>
</h4>
<p>The MPG has typically been constructed using shortest path links
between the perimeters of two dimensional node patches. In habitat
connectivity terms, this implies that landscape structure in the
“matrix” between patches is influencing movement, and that the organism
in question is on average minimizing its costs when moving through this
matrix (an assumption possibly appropriate for terrestrial animals, and
terrestrial animal-dispersed plants). Equally, MPGs can be constructed
using Euclidean links, where the only influence of the matrix on
movement is the effect of spatial separation (<em>i.e.</em>, distance it
presents between neighbouring habitat).</p>
<p>Here, we illustrate just the case where links are shortest paths on a
resistance surface. Euclidean links can be produced by passing a uniform
cost surface (a constant raster), and a raster describing the patches.
An example of this is given later in the document.</p>
<p>We begin by loading a landscape raster distributed with the package.
Note that any raster format readable using the <code>raster</code>
package can be used here. The <code>.asc</code> format rasters
distributed with the package are <em>ESRI ArcASCII</em> format.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">patchy</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/patchy.asc"</span>, package <span class="op">=</span> <span class="st">"grainscape"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then, for convenience, we use R to turn this raster into a resistance
surface. In this example we will assume the feature class 1
(<em>i.e.</em>, cells with <code>value == 1</code>) are the patches. We
will set them to resistance value also equal to <code>1</code>
(<em>i.e.</em>, no additional resistance to movement than distance
alone). The river, feature class 2, is assigned the highest resistance
of <code>10</code>. Other features are assigned values in between. The
parameterization of resistance surfaces for landscape connectivity
modelling is itself a big topic <span class="citation">(Zeller,
McGarigal, and Whiteley 2012)</span>. The matrix <code>isBecomes</code>
describes the transformation from feature class to resistance surface.
The result is shown in .</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create an is-becomes matrix for reclassification</span></span>
<span><span class="va">isBecomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">patchyCost</span> <span class="op">&lt;-</span> <span class="fu">reclassify</span><span class="op">(</span><span class="va">patchy</span>, rcl <span class="op">=</span> <span class="va">isBecomes</span><span class="op">)</span></span>
<span><span class="va">patchyCost_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">patchyCost</span><span class="op">)</span></span>
<span><span class="va">patchyCost_df</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">patchyCost_df</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot this raster using ggplot2 functionality</span></span>
<span><span class="co">## and the default grainscape theme</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">patchyCost_df</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"div"</span>, palette <span class="op">=</span> <span class="st">"Paired"</span>, guide <span class="op">=</span> <span class="st">"legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Resistance"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_grainscape.html">theme_grainscape</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_03-1.png" alt="\label{fig:patchycost}Input raster resistance surface to create the minimum planar graph (MPG). Features with value of 1 (red) will be the patches in the network. A river (light blue) has the highest resistance in this example." width="288"><p class="caption">
Input raster resistance surface to create the minimum planar graph
(MPG). Features with value of 1 (red) will be the patches in the
network. A river (light blue) has the highest resistance in this
example.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="step-2-extracting-the-mpg">Step 2: Extracting the MPG<a class="anchor" aria-label="anchor" href="#step-2-extracting-the-mpg"></a>
</h4>
<p>With a resistance surface in hand the next step is to create the MPG.
Basic use of the function, <code><a href="../reference/MPG.html">MPG()</a></code> to do this is shown here.
For simplicity we assume that all areas with the resistance value equal
to <code>1</code> on the raster are patches. This is a convenient short
cut when patches are the only part of the raster where resistance is
equal to geographic distance. However, in many applications focal
patches will be a subset of these areas, or represent areas with
multiple resistance values. These can be accommodated by passing a patch
raster to the <code>patch=</code> parameter, created using any method.
Equally patches below a certain size could be filtered by passing the
patch raster to <code>patchfilter()</code> first.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">patchyMPG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MPG.html">MPG</a></span><span class="op">(</span><span class="va">patchyCost</span>, patch <span class="op">=</span> <span class="op">(</span><span class="va">patchyCost</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="step-3-quick-visualization-of-the-mpg">Step 3: Quick visualization of the MPG<a class="anchor" aria-label="anchor" href="#step-3-quick-visualization-of-the-mpg"></a>
</h4>
<p>A quick way to visualize the MPG is provided by the <code>plot</code>
method in <code>grainscape</code>. This appears in .</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">patchyMPG</span>, quick <span class="op">=</span> <span class="st">"mpgPlot"</span>, theme <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_04-1.png" alt="\label{fig:mpgplot}A quick visualization of the minimum planar graph (MPG). Grey areas are patches (nodes) in the graph, and green lines are links showing the shortest paths between the perimeters of the patches on the resistance surface. In depth discussion of how the MPG is generated can be found elsewhere [@Fall:2007eo]." width="288"><p class="caption">
A quick visualization of the minimum planar graph (MPG). Grey areas are
patches (nodes) in the graph, and green lines are links showing the
shortest paths between the perimeters of the patches on the resistance
surface. In depth discussion of how the MPG is generated can be found
elsewhere <span class="citation">(Fall et al. 2007)</span>.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="step-4-reporting-on-the-mpg">Step 4: Reporting on the MPG<a class="anchor" aria-label="anchor" href="#step-4-reporting-on-the-mpg"></a>
</h4>
<p>Following extraction, the MPG is available as an <code>igraph</code>
object (see <code>patchyMPG@mpg</code>) and can be analyzed using any of
the functions in this package. A quick way to report on the structure of
the graph in tabular format is provided by the function
<code><a href="../reference/graphdf.html">graphdf()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract tabular node information using the graphdf() function</span></span>
<span><span class="va">nodeTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graphdf.html">graphdf</a></span><span class="op">(</span><span class="va">patchyMPG</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">v</span></span>
<span></span>
<span><span class="co">## Render table using the kable function,</span></span>
<span><span class="co">## retaining the first three rows</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">nodeTable</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span>, digits <span class="op">=</span> <span class="fl">0</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="7%">
<col width="12%">
<col width="15%">
<col width="21%">
<col width="13%">
<col width="15%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="right">name</th>
<th align="right">patchId</th>
<th align="right">patchArea</th>
<th align="right">patchEdgeArea</th>
<th align="right">coreArea</th>
<th align="right">centroidX</th>
<th align="right">centroidY</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">5</td>
<td align="right">5</td>
<td align="right">3995</td>
<td align="right">388</td>
<td align="right">3607</td>
<td align="right">81</td>
<td align="right">-33</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">7</td>
<td align="right">1682</td>
<td align="right">189</td>
<td align="right">1493</td>
<td align="right">356</td>
<td align="right">-28</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">9</td>
<td align="right">937</td>
<td align="right">154</td>
<td align="right">783</td>
<td align="right">302</td>
<td align="right">-54</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract tabular link information using the graphdf() function</span></span>
<span><span class="va">linkTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graphdf.html">graphdf</a></span><span class="op">(</span><span class="va">patchyMPG</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">e</span></span>
<span></span>
<span><span class="co">## Render table using the kable function,</span></span>
<span><span class="co">## retaining the first three rows</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">linkTable</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span>, digits <span class="op">=</span> <span class="fl">0</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="4%">
<col width="4%">
<col width="9%">
<col width="20%">
<col width="16%">
<col width="16%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="right">e1</th>
<th align="right">e2</th>
<th align="right">linkId</th>
<th align="right">lcpPerimWeight</th>
<th align="right">startPerimX</th>
<th align="right">startPerimY</th>
<th align="right">endPerimX</th>
<th align="right">endPerimY</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">24</td>
<td align="right">37</td>
<td align="right">1</td>
<td align="right">45</td>
<td align="right">315</td>
<td align="right">-259</td>
<td align="right">314</td>
<td align="right">-246</td>
</tr>
<tr class="even">
<td align="right">36</td>
<td align="right">37</td>
<td align="right">2</td>
<td align="right">90</td>
<td align="right">342</td>
<td align="right">-273</td>
<td align="right">360</td>
<td align="right">-262</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">12</td>
<td align="right">3</td>
<td align="right">120</td>
<td align="right">289</td>
<td align="right">-70</td>
<td align="right">277</td>
<td align="right">-97</td>
</tr>
</tbody>
</table>
<p>The output in shows the structure of the nodes (vertices) and their
attributes under the list element <code>$v</code> as well as the
structure of the graph in the form of an link list (<em>i.e.</em>, pairs
of nodes <code>e1</code> and <code>e2</code> that are connected) and
associated link (edge) attributes under the list element
<code>$e</code>. Note that only the first three lines of each has been
reproduced here. Please see the manual for the interpretation of the
attributes.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="step-5-thresholding-the-mpg">Step 5: Thresholding the MPG<a class="anchor" aria-label="anchor" href="#step-5-thresholding-the-mpg"></a>
</h4>
<p>A frequent step in the analysis of a network is to threshold it into
a series of clusters or components representing connected areas <span class="citation">(Urban and Keitt 2001; Galpern, Manseau, and Fall 2011;
Galpern, Manseau, and Wilson 2012)</span>. This has sometimes been
called a scalar analysis <span class="citation">(Brooks
2003)</span>.</p>
<p>The function <code><a href="../reference/threshold.html">threshold()</a></code> provides a way to conduct a
scalar analysis at multiple scales. Here we ask for 5 thresholds, and
the function finds five approximately evenly-spaced threshold values in
link length.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scalarAnalysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/threshold.html">threshold</a></span><span class="op">(</span><span class="va">patchyMPG</span>, nThresh <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use kable to render this as a table</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">scalarAnalysis</span><span class="op">$</span><span class="va">summary</span>,</span>
<span>  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>    <span class="st">"The number of components ('nComponents') in the"</span>,</span>
<span>    <span class="st">"minimum planar graph at five automatically-selected"</span>,</span>
<span>    <span class="st">"link thresholds ('maxLink)."</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>The number of components (‘nComponents’) in the minimum planar
graph at five automatically-selected link thresholds
(’maxLink).</caption>
<thead><tr class="header">
<th align="right">maxLink</th>
<th align="right">nComponents</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">229</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">458</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">687</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">916</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>The <code>$summary</code> of this analysis can be plotted to explore
scales of aggregation in the landscape. shows a scalar analysis of this
landscape with 100 thresholds, where the response variables is the
number of components or sub-graphs created by the thresholding.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scalarAnalysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/threshold.html">threshold</a></span><span class="op">(</span><span class="va">patchyMPG</span>, nThresh <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">scalarAnalysis</span><span class="op">$</span><span class="va">summary</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">maxLink</span>, y <span class="op">=</span> <span class="va">nComponents</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Link Threshold (resistance units)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Number of components"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span>, by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_05-1.png" alt="\label{fig:scalesaggregation}A scalar analysis at 100 thresholds of the MPG in \autoref{fig:mpgplot}. When the landscape is a single component at higher link thresholds all patches are completely connected. As an example, an organism able to disperse 250 resistance units would experience this landscape as six connected regions." width="288"><p class="caption">
A scalar analysis at 100 thresholds of the MPG in . When the landscape
is a single component at higher link thresholds all patches are
completely connected. As an example, an organism able to disperse 250
resistance units would experience this landscape as six connected
regions.
</p>
</div>
<p>Other independent variables describing the components (<em>e.g.</em>,
area of patches) could, of course, be calculated by processing the
thresholded graphs <code>scalarAnalysis$th</code> and their attributes
using the <code>igraph</code> function <code>components()</code>.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="step-6-visualizing-a-thresholded-graph">Step 6: Visualizing a thresholded graph<a class="anchor" aria-label="anchor" href="#step-6-visualizing-a-thresholded-graph"></a>
</h4>
<p>Consider an organism able to disperse a maximum of 250 resistance
units. According to this organism would experience this landscape as 6
connected regions. This is visualized in .</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">patchyMPG</span>, <span class="st">"patchId"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">patchyMPG</span>, <span class="st">"links"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, xend <span class="op">=</span> <span class="va">x2</span>, yend <span class="op">=</span> <span class="va">y2</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">lcpPerimWeight</span> <span class="op">&gt;=</span> <span class="fl">250</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forestgreen"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">patchyMPG</span>, <span class="st">"nodes"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"darkgreen"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_06-1.png" alt="\label{fig:thresholdedgraph}The thresholded MPG depicted with a link length of 250 resistance units. An organism that can disperse a maximum of 250 resistance units would experience this landscape as 6 connected regions in the depicted spatial configuration. Note that the plotting has been customized to emphasize which patches are connected. This was done by plotting links with less than the threshold length from the centroids of patches" width="288"><p class="caption">
The thresholded MPG depicted with a link length of 250 resistance units.
An organism that can disperse a maximum of 250 resistance units would
experience this landscape as 6 connected regions in the depicted spatial
configuration. Note that the plotting has been customized to emphasize
which patches are connected. This was done by plotting links with less
than the threshold length from the centroids of patches
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="step-7-next-steps">Step 7: Next steps<a class="anchor" aria-label="anchor" href="#step-7-next-steps"></a>
</h4>
<p>With the MPG in hand, several additional types of analyses are
possible. Grains of connectivity (GOC), the subject of the next section,
is an example of using the MPG and its complement the Voronoi
tessellation.</p>
<p>When programming your own analyses in R based on the MPG it is
helpful to observe that the <code>patchyMPG@patchId</code> and
<code>patchyMPG@lcpLinkId</code> rasters contain the numerical IDs of
the patches (nodes) and links respectively. These are are also contained
as attributes in the <code>igraph</code> object
<code>patchyMPG@mpg</code>. Using these three data objects together
gives flexibility to visualize any graph analysis. Additional example
visualizations and analyses are contained later in this document.</p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level3">
<h3 id="model-2-patch-grains-of-connectivity">Model 2: Patch grains of connectivity<a class="anchor" aria-label="anchor" href="#model-2-patch-grains-of-connectivity"></a>
</h3>
<p>Grains of connectivity (hereafter GOC) was initially developed in
three papers <span class="citation">(Galpern, Manseau, and Wilson 2012;
Galpern and Manseau 2013b, 2013a)</span>. Please refer to these papers
for much more detail on this method. In summary, grains of connectivity
describes a tessellation of functionally-connected regions of the map.
In this example we present these in the context of modelling landscape
connectivity for highly-mobile terrestrial organisms that are not
obligate patch occupants.</p>
<div class="section level4">
<h4 id="step-1-begin-with-a-mpg">Step 1: Begin with a MPG<a class="anchor" aria-label="anchor" href="#step-1-begin-with-a-mpg"></a>
</h4>
<p>Here, we repeat the steps as before for the same <code>patchy</code>
resistance surface explored in the MPG examples. Any of the variations
imaginable for the MPG modelling can provide a valid basis to build a
GOC.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load the patchy raster distributed with grainscape</span></span>
<span><span class="va">patchy</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/patchy.asc"</span>, package <span class="op">=</span> <span class="st">"grainscape"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create an is-becomes matrix for reclassification</span></span>
<span><span class="va">isBecomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">patchyCost</span> <span class="op">&lt;-</span> <span class="fu">reclassify</span><span class="op">(</span><span class="va">patchy</span>, rcl <span class="op">=</span> <span class="va">isBecomes</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create the MPG model using cells = 1 as patches</span></span>
<span><span class="va">patchyMPG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MPG.html">MPG</a></span><span class="op">(</span><span class="va">patchyCost</span>, patch <span class="op">=</span> <span class="op">(</span><span class="va">patchyCost</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="step-2-exploring-the-voronoi-tessellation">Step 2: Exploring the Voronoi tessellation<a class="anchor" aria-label="anchor" href="#step-2-exploring-the-voronoi-tessellation"></a>
</h4>
<p>Before we build the GOC graph, we should explore the essential
building block of GOC, which is the Voronoi tessellation. This
particular Voronoi tessellation was first described elsewhere <span class="citation">(Fall et al. 2007)</span> and is the complement of the
MPG. It is identified by finding the region of proximity in resistance
units around a resource patch. In contrast to the well-known Voronoi
tessellation where the generators are points and distance is Euclidean,
this tessellation uses two-dimensional patches as generators and
distance is calculated in cost or resistance space. The tessellation is
found in <code>grainscape</code> using a marching algorithm implemented
in <code>C++</code>.</p>
<p>The Voronoi tessellation is extracted as part of finding the
<code><a href="../reference/MPG.html">MPG()</a></code>. A plot with the Voronoi tessellation and the patches
superimposed is shown in .</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">patchPlusVoronoi</span> <span class="op">&lt;-</span> <span class="va">patchyMPG</span><span class="op">@</span><span class="va">voronoi</span></span>
<span><span class="va">patchPlusVoronoi</span><span class="op">[</span><span class="va">patchyMPG</span><span class="op">@</span><span class="va">patchId</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">patchPlusVoronoi</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_07-1.png" alt="\label{fig:voronoitessellation}A Voronoi tessellation. This is the complement of the MPG. The patches (darkest blue) are used as generators, and regions of proximity (polygons of different colours) are found in cost or resistance units. The method was first described by @Fall:2007eo." width="288"><p class="caption">
A Voronoi tessellation. This is the complement of the MPG. The patches
(darkest blue) are used as generators, and regions of proximity
(polygons of different colours) are found in cost or resistance units.
The method was first described by <span class="citation">Fall et al.
(2007)</span>.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="step-3-building-goc-models">Step 3: Building GOC models<a class="anchor" aria-label="anchor" href="#step-3-building-goc-models"></a>
</h4>
<p>GOC analysis is essentially a scalar or thresholding analysis (see
<code><a href="../reference/threshold.html">threshold()</a></code> and above) except the graph being thresholded
is one of Voronoi polygons rather than patches. In particular, it is the
MPG of Voronoi polygons that is thresholded. As links are added, and
Voronoi polygons linked, the relevant polygons are combined describing
larger connected regions. An additional step is that the links
connecting a pair of polygons are the mean value of all links connecting
any patches in each of the two polygons from the MPG <span class="citation">(Galpern, Manseau, and Wilson 2012)</span>.</p>
<p>The function <code><a href="../reference/GOC.html">GOC()</a></code> builds GOC models at multiple
thresholds. As with <code><a href="../reference/threshold.html">threshold()</a></code> we can specify the number
of thresholds, or grains of connectivity models, we want to create using
the <code>nThresh</code> parameter.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">patchyGOC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GOC.html">GOC</a></span><span class="op">(</span><span class="va">patchyMPG</span>, nThresh <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="step-4-visualizing-a-goc-model">Step 4: Visualizing a GOC model<a class="anchor" aria-label="anchor" href="#step-4-visualizing-a-goc-model"></a>
</h4>
<p>To get a quick sense of the connected regions described by a GOC
model at a given threshold (or scale of movement) we can use the
function <code><a href="../reference/grain.html">grain()</a></code>. This example uses the functions plotting
mechanism to plot the 6th threshold in the <code>patchyGOC</code>
object. shows the resulting plot.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/grain.html">grain</a></span><span class="op">(</span><span class="va">patchyGOC</span>, whichThresh <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, quick <span class="op">=</span> <span class="st">"grainPlot"</span>, theme <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Extracting voronoi boundaries...</span></span></code></pre>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_08-1.png" alt="\label{fig:gocthresh}A visualization of a GOC model. In this case it is the 6th scale or threshold extracted. Voronoi polygons imply regions that are functionally-connected at the given movement threshold." width="288"><p class="caption">
A visualization of a GOC model. In this case it is the 6th scale or
threshold extracted. Voronoi polygons imply regions that are
functionally-connected at the given movement threshold.
</p>
</div>
<p>The remainder of this document serves as a reference to modelling,
visualization and analysis using the <code>grainscape</code> package.
Please refer to the visual table of contents.</p>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="landscape-networks-with-1d-and-2d-nodes">Landscape networks with 1D and 2D nodes<a class="anchor" aria-label="anchor" href="#landscape-networks-with-1d-and-2d-nodes"></a>
</h2>
<div class="section level3">
<h3 id="modelling">Modelling<a class="anchor" aria-label="anchor" href="#modelling"></a>
</h3>
<div class="section level4">
<h4 id="planar-network-with-one-dimensional-nodes-on-a-euclidean-surface">Planar network with one-dimensional nodes on a Euclidean
surface<a class="anchor" aria-label="anchor" href="#planar-network-with-one-dimensional-nodes-on-a-euclidean-surface"></a>
</h4>
<p>One-dimensional nodes (<em>i.e.</em>, points) can represent map
locations of an ecological or spatial process of interest. While the
Euclidean distance between these points is easily calculated in R using
the <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist()</a></code> function, we may be interested in the path
distance to just the immediate neighbours of each point. A
<em>planar</em> network extracted on a Euclidean resistance surface can
be used to identify which nodes are neighbours and find their pairwise
distances <span class="citation">(Fall et al. 2007; Galpern, Manseau,
and Fall 2011)</span>. In <code>grainscape</code> a Euclidean resistance
surface is simply a resistance surface where all values are
<code>= 1</code>)</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Make a new resistance raster of 400 by 400 cells</span></span>
<span><span class="co">## with a coordinate system that corresponds to cells</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span>xmn <span class="op">=</span> <span class="fl">0</span>, xmx <span class="op">=</span> <span class="fl">100</span>, ymn <span class="op">=</span> <span class="fl">0</span>, ymx <span class="op">=</span> <span class="fl">100</span>, resolution <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Assign all values to 1</span></span>
<span><span class="va">res</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co">## Create 20 "random" points representing nodes,</span></span>
<span><span class="co">## (i.e. the loci of a process of interest)</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">90</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">90</span>, length.out <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Represent these on a patch raster</span></span>
<span><span class="co">## by duplicating the resistance raster and</span></span>
<span><span class="co">## setting the relevant cells to 1</span></span>
<span><span class="va">patchPts</span> <span class="op">&lt;-</span> <span class="va">res</span></span>
<span><span class="va">patchPts</span> <span class="op">&lt;-</span> <span class="fu">setValues</span><span class="op">(</span><span class="va">patchPts</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">patchPts</span><span class="op">[</span><span class="fu">cellFromXY</span><span class="op">(</span><span class="va">patchPts</span>, <span class="va">pts</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co">## Extract the MPG</span></span>
<span><span class="va">mpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MPG.html">MPG</a></span><span class="op">(</span><span class="va">res</span>, <span class="va">patchPts</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot the result using the quick 'network' visualization</span></span>
<span><span class="co">## setting and add labels (dodging them by 3 to the upper-right)</span></span>
<span><span class="va">figure09</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mpg</span>, quick <span class="op">=</span> <span class="st">"network"</span>, theme <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="st">"nodes"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="fl">3</span>, label <span class="op">=</span> <span class="va">patchId</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Planar 1D; Euclidean surface"</span><span class="op">)</span></span>
<span><span class="va">figure09</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_09-1.png" alt="A planar network with one-dimensional point nodes extracted using `grainscape`. Nodes are represented as points and labelled with their `patchId`. Links are line segments among nodes." width="288"><p class="caption">
A planar network with one-dimensional point nodes extracted using
<code>grainscape</code>. Nodes are represented as points and labelled
with their <code>patchId</code>. Links are line segments among nodes.
</p>
</div>
<p>The distance between nodes can be extracted from the objects. Note
how the distances are integers, because they do not represent the
Euclidean distance, but rather the accumulated path distance among
nodes. On this particular raster one cell equals one unit of distance,
therefore distances are the count of cells separating nodes.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Here we show the first five rows of the link attribute table</span></span>
<span><span class="co">## extracted from the mpg object. This shows selected columns,</span></span>
<span><span class="co">## using the formatting function kable()</span></span>
<span><span class="va">neighbours</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graphdf.html">graphdf</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">e</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">neighbours</span> <span class="op">&lt;-</span> <span class="va">neighbours</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">neighbours</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">neighbours</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Node 1"</span>, <span class="st">"Node 2"</span>, <span class="st">"Path distance (Euclidean)"</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">neighbours</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Node 1</th>
<th align="right">Node 2</th>
<th align="right">Path distance (Euclidean)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">5</td>
<td align="right">7</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">6</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">12</td>
<td align="right">32</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">8</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">10</td>
<td align="right">31</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="planar-network-with-one-dimensional-nodes-on-a-non-euclidean-resistance-surface">Planar network with one-dimensional nodes on a non-Euclidean
resistance surface<a class="anchor" aria-label="anchor" href="#planar-network-with-one-dimensional-nodes-on-a-non-euclidean-resistance-surface"></a>
</h4>
<p>Similarly, when the distance among points, or nodes, is best
explained by some cost or resistance, neighbour distance can be modelled
in an identical manner, leveraging the planarity of the network. The
only difference in the code from the previous 1D Euclidean example is
the use of the resistance surface rather than a raster consisting only
of the value <code>1</code>. We will borrow objects made in previous
steps to keep the code concise.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Add some cost values to the resistance</span></span>
<span><span class="co">## surface we used in the last step</span></span>
<span><span class="co">## Here we use random integers &gt;= 2</span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="va">res</span></span>
<span><span class="va">res2</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu">ncell</span><span class="op">(</span><span class="va">res2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract the minimum planar graph using the</span></span>
<span><span class="co">## raster made previously which represents the points only</span></span>
<span><span class="va">mpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MPG.html">MPG</a></span><span class="op">(</span><span class="va">res2</span>, <span class="va">patchPts</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot the result using the quick 'mgplot' visualization</span></span>
<span><span class="co">## setting and add labels (dodging them by 3 to the upper-right)</span></span>
<span><span class="co">## This demonstrates the non-linear paths.</span></span>
<span><span class="va">figure10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mpg</span>, quick <span class="op">=</span> <span class="st">"mpgPlot"</span>, theme <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="st">"nodes"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="fl">3</span>, label <span class="op">=</span> <span class="va">patchId</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Planar 1D; Resistance surface"</span><span class="op">)</span></span>
<span><span class="va">figure10</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_10-1.png" alt="A planar network with one-dimensional nodes extracted on a resistance surface. Nodes are represented by grey-coloured cells and labelled with their `patchId`. Links are green paths between nodes, shown in a spatially-explicit representation." width="288"><p class="caption">
A planar network with one-dimensional nodes extracted on a resistance
surface. Nodes are represented by grey-coloured cells and labelled with
their <code>patchId</code>. Links are green paths between nodes, shown
in a spatially-explicit representation.
</p>
</div>
<p>The distances between nodes are still integers, and they also
represent a path distance. Now, this is rather the shortest accumulated
path distance through the resistance surface between nodes. Once again,
their metric is an integer because resistance values were also integers.
The table below demonstrates that the non-Euclidean path distance is
longer among the same pairs of nodes, and they are not perfectly
correlated, as we expect.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Here we show the first five rows of the link attribute table</span></span>
<span><span class="co">## extracted from the mpg object. This shows selected columns, using</span></span>
<span><span class="co">## the formatting function kable()</span></span>
<span><span class="va">resNeighbours</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graphdf.html">graphdf</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">e</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">resNeighbours</span> <span class="op">&lt;-</span> <span class="va">resNeighbours</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">resNeighbours</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">neighbours</span>, <span class="va">resNeighbours</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Path distance (Resistance)"</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">comparison</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Node 1</th>
<th align="right">Node 2</th>
<th align="right">Path distance (Euclidean)</th>
<th align="right">Path distance (Resistance)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">5</td>
<td align="right">7</td>
<td align="right">19</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">6</td>
<td align="right">20</td>
<td align="right">110</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">12</td>
<td align="right">32</td>
<td align="right">123</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">8</td>
<td align="right">24</td>
<td align="right">106</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">10</td>
<td align="right">31</td>
<td align="right">126</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="planar-network-with-two-dimensional-nodes-on-a-non-euclidean-resistance-surface-minimum-planar-graph">Planar network with two-dimensional nodes on a non-Euclidean
resistance surface (minimum planar graph)<a class="anchor" aria-label="anchor" href="#planar-network-with-two-dimensional-nodes-on-a-non-euclidean-resistance-surface-minimum-planar-graph"></a>
</h4>
<p>This is the minimum planar graph (MPG) <span class="citation">(Fall
et al. 2007)</span>, and the inspiration for the <code>grainscape</code>
package. Please see the first part of this document for a more thorough
presentation of the MPG. Andrew Fall and colleagues originally
articulated this graph theory-based model as a <em>spatial graph</em>.
It was an approach that built a graph (or a network) of patches and,
critically, it was aware of a spatially-explicit landscape. This
incorporated multiple landscape elements that might be visible on a map,
such as the shape, size and configuration of two-dimensional node
patches as well as continuous geographic variation in the spaces between
the nodes (<em>i.e.</em>, the matrix). In a minimum planar graph (MPG)
the matrix presents resistance to connectivity and influences the paths
and therefore the lengths of the links. The shape, size and
configuration of patches with respect to their neighbours that
influences where on the patch perimeters these links begin and end. The
value of using patch perimeters rather than centroids is that it
potentially improves the estimation of the shortest paths among
patches.</p>
<p>An MPG can be understood as a planar network (<em>i.e.</em>, no links
“cross” nodes), that provides an efficient representation of connections
among neighbouring nodes. Its nodes are two-dimensional patches and its
links are the shortest paths through a resistance surface.</p>
<p>The following example uses a more realistic resistance surface based
on a simulated land cover raster.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load a land cover raster distributed with grainscape</span></span>
<span><span class="va">frag</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/fragmented.asc"</span>, package <span class="op">=</span> <span class="st">"grainscape"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Convert land cover to resistance units</span></span>
<span><span class="co">## Use an "is-becomes" reclassification</span></span>
<span><span class="va">isBecomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fragRes</span> <span class="op">&lt;-</span> <span class="fu">reclassify</span><span class="op">(</span><span class="va">frag</span>, rcl <span class="op">=</span> <span class="va">isBecomes</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract a network using cells = 1 on original raster</span></span>
<span><span class="co">## as the focal patches or nodes</span></span>
<span><span class="va">patches</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">frag</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fragMPG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MPG.html">MPG</a></span><span class="op">(</span><span class="va">fragRes</span>, patch <span class="op">=</span> <span class="va">patches</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot the minimum planar graph with node labels for several</span></span>
<span><span class="co">## focal nodes of interest</span></span>
<span><span class="va">figure11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fragMPG</span>, quick <span class="op">=</span> <span class="st">"mpgPlot"</span>, theme <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"nodes"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>,</span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">patchId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">23</span>, <span class="fl">52</span>, <span class="fl">106</span>, <span class="fl">158</span>, <span class="fl">221</span><span class="op">)</span>,</span>
<span>        <span class="va">patchId</span>, <span class="st">""</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Planar 2D; Resistance surface"</span><span class="op">)</span></span>
<span><span class="va">figure11</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_11-1.png" alt="A minimum planar graph (MPG) of a simulated resistance surface. Focal patches are grey regions and green lines indicate spatially-explicit links among patches. Several patches are labelled with their numerical `patchId`." width="288"><p class="caption">
A minimum planar graph (MPG) of a simulated resistance surface. Focal
patches are grey regions and green lines indicate spatially-explicit
links among patches. Several patches are labelled with their numerical
<code>patchId</code>.
</p>
</div>
<p>The distances from the perimeters of the nodes along the paths of the
links (green in figure) are available in the output object in the same
manner as before.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Here we show only patch 7 and its neighbours that are labelled on</span></span>
<span><span class="co">## the network using the formatting function kable().</span></span>
<span><span class="va">fragNeighbours</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graphdf.html">graphdf</a></span><span class="op">(</span><span class="va">fragMPG</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">e</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">fragNeighbours</span> <span class="op">&lt;-</span> <span class="va">fragNeighbours</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">fragNeighbours</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fragNeighbours</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Node 1"</span>, <span class="st">"Node 2"</span>, <span class="st">"Path distance (Resistance)"</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">fragNeighbours</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Node 1</th>
<th align="right">Node 2</th>
<th align="right">Path distance (Resistance)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">7</td>
<td align="right">23</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">52</td>
<td align="right">90</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">106</td>
<td align="right">135</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">158</td>
<td align="right">137</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">221</td>
<td align="right">235</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level3">
<h3 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<div class="section level4">
<h4 id="centroid-representation-of-nodes">Centroid representation of nodes<a class="anchor" aria-label="anchor" href="#centroid-representation-of-nodes"></a>
</h4>
<p>Where nodes represent two-dimensional regions (<em>e.g</em>, patches,
protected areas) it can be convenient to visualize nodes as points
plotted at the centroid location of the region <span class="citation">(Urban and Keitt 2001; Galpern, Manseau, and Fall
2011)</span>. While the links themselves may be <em>measured</em> from
patch perimeters, or quantities related to the nodes <em>summarized</em>
across patch areas, visualization can be improved by omitting
complexities such as these. Cases where centroid node representation may
be justified include: (1) mapping of the topology of a complex network;
(2) mapping the number and distribution of links; (3) mapping the
properties of the nodes (see example below); or, (4) where a large
plotting extent makes regions hard to see.</p>
<p>This example uses the resistance surface and minimum planar graph
from a previous example (<code>fragMPG</code>).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot the minimum planar graph using centroid nodes</span></span>
<span><span class="co">## A single line of code will do this as follows:</span></span>
<span><span class="co">## plot(fragMPG, quick = "network")</span></span>
<span></span>
<span><span class="co">## However the following approach gives more control,</span></span>
<span><span class="co">## allowing reduction of the size of the nodes to avoid crowding</span></span>
<span><span class="va">figure12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"links"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, xend <span class="op">=</span> <span class="va">x2</span>, yend <span class="op">=</span> <span class="va">y2</span>,</span>
<span>      colour <span class="op">=</span> <span class="st">"forestgreen"</span>, size <span class="op">=</span> <span class="fl">0.25</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"nodes"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, colour <span class="op">=</span> <span class="st">"darkgreen"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_colour_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_size_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Centroid representation of nodes"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figure12</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_12-1.png" alt="A minimum planar graph (MPG) shown with centroid node representation and linear link representation among these nodes." width="288"><p class="caption">
A minimum planar graph (MPG) shown with centroid node representation and
linear link representation among these nodes.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="perimeter-representation-of-links">Perimeter representation of links<a class="anchor" aria-label="anchor" href="#perimeter-representation-of-links"></a>
</h4>
<p>Where the spatially-explicit nature of the connections among these
nodes is important, perimeter representation of links and
two-dimensional visualization of the nodes may be a useful
technique.</p>
<p>Plotting the region covered by a node, and links as lines drawn
between the perimeters of these regions is an efficient way to convey
the topology of the network and which parts of a node are closest to its
neighbours. It also signals that the linking of nodes was done from the
perimeter rather than the centroid.</p>
<p>This example extends the previous one, where centroid representation
of links was used.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot the minimum planar graph using perimeter links</span></span>
<span><span class="co">## and two dimensional nodes</span></span>
<span><span class="va">figure13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fragMPG</span>, quick <span class="op">=</span> <span class="st">"mpgPerimPlot"</span>, theme <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Perimeter representation of links"</span><span class="op">)</span></span>
<span><span class="va">figure13</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_13-1.png" alt="A minimum planar graph (MPG) with links represented from the perimeter of the patches (*i.e.*, at the start and end points of spatially-explicit links). This rendering can simplify visualization." width="288"><p class="caption">
A minimum planar graph (MPG) with links represented from the perimeter
of the patches (<em>i.e.</em>, at the start and end points of
spatially-explicit links). This rendering can simplify visualization.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="spatially-explicit-representation-of-links">Spatially-explicit representation of links<a class="anchor" aria-label="anchor" href="#spatially-explicit-representation-of-links"></a>
</h4>
<p>Spatially-explicit representation of the links implies both that the
end points of links are on the perimeter of the region represented by
the node, and that the predicted shortest paths among those node
perimeters have coordinates. This approach conveys all available spatial
information in the minimum planar graph. It also has the potential to
mislead. Shortest paths between nodes are estimates of the shortest
distance on the resistance surface and not necessarily of the route by
which the process of interest actually flows. This kind of
representation should therefore be used with appropriate caution.</p>
<p>However, using this visualization does efficiently communicate how
the minimum planar graph model was constructed, and suggests which parts
of the resistance surface may influence the pattern of the connections
among nodes, both of which may aid in interpretation.</p>
<p>This example uses this same data as the previous one to permit
comparison among visualizations.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot the minimum planar graph using spatially-explicit links</span></span>
<span><span class="co">## and two dimensional nodes.</span></span>
<span><span class="va">figure14</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fragMPG</span>, quick <span class="op">=</span> <span class="st">"mpgPlot"</span>, theme <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Spatially-explicit representation of links"</span><span class="op">)</span></span>
<span><span class="va">figure14</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_14-1.png" alt="A minimum planar graph (MPG) with the shortest links among patch perimeters rendered as spatially-explicit paths. This rendering can help demonstrate the modelling procedure, but risks overinterpretation of the actual paths involved (see text)." width="288"><p class="caption">
A minimum planar graph (MPG) with the shortest links among patch
perimeters rendered as spatially-explicit paths. This rendering can help
demonstrate the modelling procedure, but risks overinterpretation of the
actual paths involved (see text).
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="characteristics-of-nodes-weights">Characteristics of nodes (weights)<a class="anchor" aria-label="anchor" href="#characteristics-of-nodes-weights"></a>
</h4>
<p>Variables that are associated with a focal ecological process at a
node can be represented on a network visualization. These variables are
sometimes known as node “weights”. For example, where nodes represent
regions such as patches of habitat or protected areas, a useful node
weight may be the area of the region represented by the node. Equally,
measures of node quality such as the area of core or edge habitat could
be represented. Any metric that is associated with the node can be
plotted at that node by varying the shape, size or colour of plotting
symbol.</p>
<p>In this example, the area of the patch represented by the node is
used to scale the size of the symbol plotted at the centroid of the
node.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figure15</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"links"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, xend <span class="op">=</span> <span class="va">x2</span>, yend <span class="op">=</span> <span class="va">y2</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"forestgreen"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"nodes"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, size <span class="op">=</span> <span class="va">patchArea</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"darkgreen"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_area</a></span><span class="op">(</span>max_size <span class="op">=</span> <span class="fl">10</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">3000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Characteristics of nodes (weights)"</span><span class="op">)</span></span>
<span><span class="va">figure15</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_15-1.png" alt="A minimum planar graph (MPG) with centroid node representation and links between centroids, where the plotted size of the node symbol has been scaled with the area of the patch it represents." width="288"><p class="caption">
A minimum planar graph (MPG) with centroid node representation and links
between centroids, where the plotted size of the node symbol has been
scaled with the area of the patch it represents.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="characteristics-of-links-weights">Characteristics of links (weights)<a class="anchor" aria-label="anchor" href="#characteristics-of-links-weights"></a>
</h4>
<p>Variables associated with links, called link weights, often contain
information on the modelled connectivity among nodes. Measures of
interest in ecology can include the expected flow of organisms, or a
variable correlated with this flow such as geographic distance or the
distance of the shortest path across a resistance surface.</p>
<p>In this example, the length of the shortest path between patch
perimeters is plotted by varying the width of the link connecting nodes.
The link weight is found as a proportion of the Euclidean distance
between those nodes. So, proportions higher than 1 imply a resistance to
movement greater than expected by distance alone. On the scale used
thinner lines describe a greater expectation of connectivity for an
ecological process that is influenced by resistance (proportion closer
to 1).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figure16</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"links"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, xend <span class="op">=</span> <span class="va">x2</span>, yend <span class="op">=</span> <span class="va">y2</span>,</span>
<span>      size <span class="op">=</span> <span class="va">lcpPerimWeight</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">x2</span> <span class="op">-</span> <span class="va">x1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">y2</span> <span class="op">-</span> <span class="va">y1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"forestgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"nodes"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, colour <span class="op">=</span> <span class="st">"darkgreen"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Characteristics of links (weights)"</span><span class="op">)</span></span>
<span><span class="va">figure16</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_16-1.png" alt="A minimum planar graph with centroid node and link representation where the width of the links has been scaled in proportion to the reduction in connectivity due to resistance. Wider links correspond to reduced connectivity." width="288"><p class="caption">
A minimum planar graph with centroid node and link representation where
the width of the links has been scaled in proportion to the reduction in
connectivity due to resistance. Wider links correspond to reduced
connectivity.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="link-thresholding-by-plotting">Link thresholding by plotting<a class="anchor" aria-label="anchor" href="#link-thresholding-by-plotting"></a>
</h4>
<p>Removing links with weights that are greater than a threshold value
is referred to as <em>link thresholding</em> and can be used to identify
components, or connected sets of nodes <span class="citation">(Urban and
Keitt 2001; Galpern, Manseau, and Fall 2011)</span>. It is the most
basic approach to scaling a network, and the technique upon which
<em>grains of connectivity</em> is based (see later examples).</p>
<p>Here, we remove links greater than a threshold of <code>20</code>.
This is measured in the units of the resistance surface. Thresholding at
this level implies we wish to remove all links that represent a
cumulative path distance on the resistance surface of 20 times the
dimension of a raster cell. The resulting components (also called
clusters) in the network identify groups of nodes that have a minimum
level of connectivity among them.</p>
<p>In the simplest approach to link thresholding, rather than
<em>remove</em> links from the network that are greater than this
threshold, we elect not to plot them. We do this by rendering longer
links as transparent (<code>NA</code> is the <code>ggplot2</code> colour
specification for transparency).</p>
<p>This visualization may be useful to demonstrate which nodes are most
strongly connected to one another. It does an adequate job of
highlighting which groups of nodes are connected as a single component
or cluster. However, we can do better. See the next example.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figure17</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"patchId"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"links"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, xend <span class="op">=</span> <span class="va">x2</span>, yend <span class="op">=</span> <span class="va">y2</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">lcpPerimWeight</span> <span class="op">&gt;</span> <span class="fl">20</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forestgreen"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"nodes"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"darkgreen"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Link thresholding by plotting"</span><span class="op">)</span></span>
<span><span class="va">figure17</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_17-1.png" alt="A link threshold representation of a minimum planar graph (MPG), where links connect the centroids of adjacent patches in the same component (cluster). Nodes that form their own component are shown as circles without links." width="288"><p class="caption">
A link threshold representation of a minimum planar graph (MPG), where
links connect the centroids of adjacent patches in the same component
(cluster). Nodes that form their own component are shown as circles
without links.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="link-thresholding-to-show-components">Link thresholding to show components<a class="anchor" aria-label="anchor" href="#link-thresholding-to-show-components"></a>
</h4>
<p>As noted in the last example, highlighting which nodes are connected
into components (or clusters) after the network has been subjected to
link thresholding can improve the visualization of connected regions of
the map.</p>
<p>Here, <code><a href="../reference/threshold.html">grainscape::threshold()</a></code> is used to remove links
longer than a certain length from the <code>igraph</code> model of the
landscape network. The <code><a href="https://r.igraph.org/reference/components.html" class="external-link">igraph::components()</a></code> function is
then called to label nodes by their membership in a particular component
(or cluster). We can then use this information to label the nodes by
their component membership. To improve the visualization, the nodes are
also plotted as large circles and the labels in a reverse colour. This
could also be done (perhaps more effectively) using a colour or shape
scale for node symbols that have been carefully selected to accentuate
patterns of interest in the figure.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Use the grainscape::threshold() function to create a new network</span></span>
<span><span class="co">## by thresholding links</span></span>
<span><span class="va">fragTh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/threshold.html">threshold</a></span><span class="op">(</span><span class="va">fragMPG</span>, doThresh <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Find the components in that thresholded network using</span></span>
<span><span class="co">## an igraph package function</span></span>
<span><span class="va">fragThC</span> <span class="op">&lt;-</span> <span class="fu">components</span><span class="op">(</span><span class="va">fragTh</span><span class="op">$</span><span class="va">th</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract the node table and append the</span></span>
<span><span class="co">## component membership information</span></span>
<span><span class="va">fragThNodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">vertex_attr</span><span class="op">(</span><span class="va">fragTh</span><span class="op">$</span><span class="va">th</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  component <span class="op">=</span> <span class="va">fragThC</span><span class="op">$</span><span class="va">membership</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## We don't want to show nodes that are in components with</span></span>
<span><span class="co">## only one node, so remove them</span></span>
<span><span class="va">singleNodes</span> <span class="op">&lt;-</span> <span class="va">fragThNodes</span><span class="op">$</span><span class="va">component</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">fragThC</span><span class="op">$</span><span class="va">csize</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fragThNodes</span> <span class="op">&lt;-</span> <span class="va">fragThNodes</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">singleNodes</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co">## Rename some columns to improve readability</span></span>
<span><span class="va">fragThNodes</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">fragThNodes</span><span class="op">$</span><span class="va">centroidX</span></span>
<span><span class="va">fragThNodes</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">fragThNodes</span><span class="op">$</span><span class="va">centroidY</span></span>
<span></span>
<span><span class="va">figure18</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"patchId"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"links"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, xend <span class="op">=</span> <span class="va">x2</span>, yend <span class="op">=</span> <span class="va">y2</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">lcpPerimWeight</span> <span class="op">&gt;</span> <span class="fl">20</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forestgreen"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">fragThNodes</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">19</span>, size <span class="op">=</span> <span class="fl">4</span>, colour <span class="op">=</span> <span class="st">"darkgreen"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">fragThNodes</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">component</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Link thresholding to show components"</span><span class="op">)</span></span>
<span><span class="va">figure18</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_18-1.png" alt="A link threshold representation of a minimum planar graph (MPG), where links connect the centroids of adjacent patches in the same component (cluster). Nodes that are part of a component are labelled with their component membership." width="288"><p class="caption">
A link threshold representation of a minimum planar graph (MPG), where
links connect the centroids of adjacent patches in the same component
(cluster). Nodes that are part of a component are labelled with their
component membership.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level3">
<h3 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h3>
<div class="section level4">
<h4 id="network-metrics-to-assess-node-importance">Network metrics to assess node importance<a class="anchor" aria-label="anchor" href="#network-metrics-to-assess-node-importance"></a>
</h4>
<p>There are numerous network metrics available that describe properties
of nodes and network topology. The <code>igraph</code> package used by
<code>grainscape</code> implements a selection of these metrics. A
simple and intuitive node-based network metric is <em>degree</em>. This
is a count of the number of links adjacent to a node. A node with a
higher degree, then, might be deemed as contributing more to
connectivity. The usefulness of this metric depends on the application,
and more sophisticated measures of node importance such as
<em>centrality</em> may be more appropriate. These are also available in
<code>igraph</code>. However caution is appropriate, as the MPG is
itself an approximation of all possible links among nodes. Please see
<span class="citation">Galpern, Manseau, and Fall (2011)</span> for more
information on this limitation.</p>
<p>Here we demonstrate how to calculate degree using the
<code>igraph</code> package and visualize the result of this simple
network analysis. We calculate degree on a link thresholded network,
implying that there is a maximum level of link resistance above which we
do not consider that link as making a contribution to a node’s
connectivity.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Assess degree on the nodes of a thresholded network</span></span>
<span><span class="co">## made in the previous example (threshold = 20)</span></span>
<span><span class="va">fragThDegree</span> <span class="op">&lt;-</span> <span class="fu">degree</span><span class="op">(</span><span class="va">fragTh</span><span class="op">$</span><span class="va">th</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Add degree to the node table</span></span>
<span><span class="va">fragThNodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">vertex_attr</span><span class="op">(</span><span class="va">fragTh</span><span class="op">$</span><span class="va">th</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, degree <span class="op">=</span> <span class="va">fragThDegree</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Remove nodes with a degree of 0</span></span>
<span><span class="va">fragThNodes</span> <span class="op">&lt;-</span> <span class="va">fragThNodes</span><span class="op">[</span><span class="va">fragThNodes</span><span class="op">$</span><span class="va">degree</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co">## Rename some columns to improve readability</span></span>
<span><span class="va">fragThNodes</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">fragThNodes</span><span class="op">$</span><span class="va">centroidX</span></span>
<span><span class="va">fragThNodes</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">fragThNodes</span><span class="op">$</span><span class="va">centroidY</span></span>
<span></span>
<span><span class="va">figure19</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"patchId"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"links"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, xend <span class="op">=</span> <span class="va">x2</span>, yend <span class="op">=</span> <span class="va">y2</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">lcpPerimWeight</span> <span class="op">&gt;</span> <span class="fl">20</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forestgreen"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">fragThNodes</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, size <span class="op">=</span> <span class="va">degree</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"darkgreen"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Node importance metrics (degree)"</span><span class="op">)</span></span>
<span><span class="va">figure19</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_19-1.png" alt="A link threshold representation of a minimum planar graph (MPG), where nodes, plotted at patch centroids, are scaled in proportion to the degree of the node (*i.e.*, the number of links adjacent on the node). Larger circles indicate nodes with a higher degree in the MPG." width="288"><p class="caption">
A link threshold representation of a minimum planar graph (MPG), where
nodes, plotted at patch centroids, are scaled in proportion to the
degree of the node (<em>i.e.</em>, the number of links adjacent on the
node). Larger circles indicate nodes with a higher degree in the MPG.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="shortest-path-distance-between-nodes">Shortest-path distance between nodes<a class="anchor" aria-label="anchor" href="#shortest-path-distance-between-nodes"></a>
</h4>
<p>Finding the shortest path through the network from a source to a
destination node and the length of that path is a useful prediction of
the network model and has many applications <span class="citation">(Zeller, McGarigal, and Whiteley 2012; Galpern,
Manseau, and Wilson 2012; Adriaensen et al. 2003)</span> . It gives an
expected distance through the network, taking into account the modelled
connectivity among nodes.</p>
<p>This example illustrates how to use <code>igraph</code> functions to
find the shortest path through the network, calculate its length in the
metric of the resistance surface, and visualize the path.</p>
<p>The plot uses links between patch centroids and recolouring of the
patch raster to add emphasis. If we were to use a link thresholded
network, here, (which we will not for simplicity), the entire network
would not be completely connected, so certain patches may not have a
shortest path between them. Finding shortest paths on thresholded
networks may still be a useful technique, and the absence of a shortest
path an important finding.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Declare the start and end patchIds</span></span>
<span><span class="co">## These were identified by plotting the patchIds (see earlier examples)</span></span>
<span><span class="va">startEnd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1546</span>, <span class="fl">94</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Find the shortest path between these nodes using</span></span>
<span><span class="co">## the shortest path through the resistance surface</span></span>
<span><span class="co">## (i.e. weighted by 'lcpPerimWeight')</span></span>
<span><span class="va">shPath</span> <span class="op">&lt;-</span> <span class="fu">shortest_paths</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span>,</span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">V</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">$</span><span class="va">patchId</span> <span class="op">==</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">V</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">$</span><span class="va">patchId</span> <span class="op">==</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu">E</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">$</span><span class="va">lcpPerimWeight</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"both"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract the nodes and links of this shortest path</span></span>
<span><span class="va">shPathN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">shPath</span><span class="op">$</span><span class="va">vpath</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">shPathL</span> <span class="op">&lt;-</span> <span class="fu">E</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">[</span><span class="va">shPath</span><span class="op">$</span><span class="va">epath</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">linkId</span></span>
<span></span>
<span><span class="co">## Produce shortest path tables for plotting</span></span>
<span><span class="va">shPathNodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"nodes"</span><span class="op">)</span>, <span class="va">patchId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">shPathN</span><span class="op">)</span></span>
<span><span class="va">shPathLinks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"links"</span><span class="op">)</span>, <span class="va">linkId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">shPathL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Find the distance of the shortest path</span></span>
<span><span class="va">shPathD</span> <span class="op">&lt;-</span> <span class="fu">distances</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span>,</span>
<span>  v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">V</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">$</span><span class="va">patchId</span> <span class="op">==</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">V</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">$</span><span class="va">patchId</span> <span class="op">==</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu">E</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">$</span><span class="va">lcpPerimWeight</span></span>
<span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Plot shortest path</span></span>
<span><span class="va">figure20</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragMPG</span>, <span class="st">"patchId"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>,</span>
<span>      fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">shPathN</span>, <span class="st">"grey70"</span>, <span class="st">"grey90"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_fill_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">shPathLinks</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, xend <span class="op">=</span> <span class="va">x2</span>, yend <span class="op">=</span> <span class="va">y2</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"forestgreen"</span>, size <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">shPathNodes</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Shortest-path distance between nodes"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="fl">260</span>, <span class="fl">340</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">shPathD</span>, <span class="st">" resistance units"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2.5</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">figure20</span></span></code></pre></div>
<div class="figure">
&lt;img
src=“/home/runner/work/grainscape/grainscape/docs/articles/grainscape_vignette_files/figure-html/figure_20-1.png”
alt=“The shortest path through a minimum planar graph (MPG) given a
start and end <code>patchId</code>. Links and nodes that form part of
this”corridor” are highlighted.” width=“288” /&gt;
<p class="caption">
The shortest path through a minimum planar graph (MPG) given a start and
end <code>patchId</code>. Links and nodes that form part of this
“corridor” are highlighted.
</p>
</div>
<p>Pairwise distances between a set of nodes can be found using the
<code><a href="https://r.igraph.org/reference/distances.html" class="external-link">igraph::distances()</a></code> function as follows.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create a pairwise table of shortest path distances among nodes using</span></span>
<span><span class="co">## the resistance surface based links</span></span>
<span><span class="va">allShPathD</span> <span class="op">&lt;-</span> <span class="fu">distances</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span>, weights <span class="op">=</span> <span class="fu">E</span><span class="op">(</span><span class="va">fragMPG</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">$</span><span class="va">lcpPerimWeight</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create a table for the first 8 nodes</span></span>
<span><span class="va">tableD</span> <span class="op">&lt;-</span> <span class="va">allShPathD</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span>
<span><span class="va">tableD</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">tableD</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">tableD</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"patchId"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">tableD</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">tableD</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">7</th>
<th align="right">10</th>
<th align="right">12</th>
<th align="right">13</th>
<th align="right">19</th>
<th align="right">23</th>
<th align="right">27</th>
<th align="right">52</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">patchId 7</td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">patchId 10</td>
<td align="right">398</td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">patchId 12</td>
<td align="right">405</td>
<td align="right">65</td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">patchId 13</td>
<td align="right">419</td>
<td align="right">95</td>
<td align="right">30</td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">patchId 19</td>
<td align="right">454</td>
<td align="right">130</td>
<td align="right">65</td>
<td align="right">35</td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">patchId 23</td>
<td align="right">27</td>
<td align="right">371</td>
<td align="right">378</td>
<td align="right">392</td>
<td align="right">427</td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">patchId 27</td>
<td align="right">534</td>
<td align="right">210</td>
<td align="right">145</td>
<td align="right">115</td>
<td align="right">80</td>
<td align="right">507</td>
<td align="right">0</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">patchId 52</td>
<td align="right">90</td>
<td align="right">488</td>
<td align="right">495</td>
<td align="right">509</td>
<td align="right">544</td>
<td align="right">117</td>
<td align="right">624</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="scaling-landscape-networks">Scaling landscape networks<a class="anchor" aria-label="anchor" href="#scaling-landscape-networks"></a>
</h2>
<div class="section level3">
<h3 id="modeling">Modeling<a class="anchor" aria-label="anchor" href="#modeling"></a>
</h3>
<div class="section level4">
<h4 id="scaling-resistance-surfaces-lattice-grains-of-connectivity">Scaling resistance surfaces (lattice grains of connectivity)<a class="anchor" aria-label="anchor" href="#scaling-resistance-surfaces-lattice-grains-of-connectivity"></a>
</h4>
<p>Resistance surfaces produced from remotely-sensed land cover or
elevation data may be too fine-scaled for the process being modelled. By
having a scale that is mismatched with the one of interest, the signal
or pattern may be obscured <span class="citation">(Cushman and Landguth
2010)</span>. A common strategy is to upscale these rasters and remove
potentially unimportant variation by coalescing adjacent raster cells
and representing these by their mode or mean. Another approach uses
moving windows to smooth out variation <span class="citation">(Galpern
and Manseau 2013a)</span>.</p>
<p><code>grainscape</code> enables a different approach to upscaling a
resistance surface based on remotely-sensed data. Lattice grains of
connectivity drops a lattice of focal points (or nodes), finds the
minimum planar graph and its complementary Voronoi polygons on the
resistance surface among these points, and then coalesces adjacent
Voronoi polygons using the graph as guidance. It can be classified as a
model-based approach to upscaling (where the model is the resistance
surface, and its representation of some ecological or geographical
process). Unlike arbitrarily upscaling a raster based on cell-proximity,
this approach uses spatial information in the surface itself. The grid
spacing of the lattice as well as the amount of link thresholding
together influence the amount of upscaling that occurs.</p>
<p>This example uses the familiar resistance surface of previous
examples. It specifies a lattice grid spacing of <code>25</code> cells.
We use <code>grainscape</code> grains of connectivity analysis functions
to coalesce Voronoi polygons at <code>5</code> thresholds or scales. We
could examine the resulting lattice grains of connectivity at any of
these five scales. We choose the third to illustrate an intermediate
level of scaling.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract a minimum planar graph and complementary</span></span>
<span><span class="co">## Voronoi polygons from the fragmented resistance surface</span></span>
<span><span class="co">## Note the use of an integer for the 'patch' parameter, which</span></span>
<span><span class="co">## specifies the spacing in cells of the lattice grid</span></span>
<span><span class="va">fragLatticeMPG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MPG.html">MPG</a></span><span class="op">(</span><span class="va">fragRes</span>, patch <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract grains of connectivity from this MPG at</span></span>
<span><span class="co">## five link thresholds (or scales)</span></span>
<span><span class="va">fragLatticeGOC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GOC.html">GOC</a></span><span class="op">(</span><span class="va">fragLatticeMPG</span>, nThresh <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Visualize the Voronoi polygons at the third threshold</span></span>
<span><span class="va">figure21</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/grain.html">grain</a></span><span class="op">(</span><span class="va">fragLatticeGOC</span>, whichThresh <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  quick <span class="op">=</span> <span class="st">"grainPlot"</span>, theme <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Lattice grains of connectivity"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Extracting voronoi boundaries...</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figure21</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_21-1.png" alt="A scaled lattice grains of connectivity (GOC) model showing the outline of Voronoi polygons in grey, and the network connections among polygons as links plotted from adjacent polygon centroids." width="288"><p class="caption">
A scaled lattice grains of connectivity (GOC) model showing the outline
of Voronoi polygons in grey, and the network connections among polygons
as links plotted from adjacent polygon centroids.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level4">
<h4 id="scaling-networks-with-two-dimensional-nodes-patch-grains-of-connectivity">Scaling networks with two-dimensional nodes (patch grains of
connectivity)<a class="anchor" aria-label="anchor" href="#scaling-networks-with-two-dimensional-nodes-patch-grains-of-connectivity"></a>
</h4>
<p>Patch grains of connectivity extends the idea of the point nodes in
the lattice model to two-dimensional node regions <span class="citation">(Galpern, Manseau, and Wilson 2012)</span>. It
leverages the minimum planar graph demonstrated in previous examples and
its complement the Voronoi tessellation of the resistance surface.
Voronoi polygons are identified and coalesced at different thresholds or
“grains” in these models.</p>
<p>A key contribution is the capacity to model landscape connectivity at
multiple spatial scales, and to account for uncertainty in the nature of
the patch and the surrounding matrix <span class="citation">(Galpern,
Manseau, and Wilson 2012; Galpern and Manseau 2013a)</span>. The use of
polygons rather than discrete two dimensional nodes (<em>i.e.</em>,
surrounded by a matrix that presents resistance) allows for uncertainty
in patch definition. Such an approach may be particularly valuable in
ecology for modelling landscape connectivity in highly-mobile
terrestrial animals, for which both patch definition and resistance
surface parameterization have large amounts of uncertainty.</p>
<p>The product is a continuously distributed set of two-dimensional
nodes, such that every point on the surface is associated with a node.
Critically these polygons can be scaled. Relationships among these
polygons are based on the relationships among two-dimensional nodes
contained within. In a later example we show how grains of connectivity
can be used to identify potential spatial corridors between points.</p>
<p>This patch grains of connectivity model uses the familiar resistance
surface and the same patches (<code>=1</code>) used in many earlier
examples.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Use the MPG extracted in previous examples to find a</span></span>
<span><span class="co">## patch grains of connectivity model, where patches</span></span>
<span><span class="co">## are cells on the resistance surface equal to 1</span></span>
<span><span class="co">## Do this at five thresholds</span></span>
<span><span class="va">fragPatchGOC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GOC.html">GOC</a></span><span class="op">(</span><span class="va">fragMPG</span>, nThresh <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot the fourth grain</span></span>
<span><span class="va">figure22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/grain.html">grain</a></span><span class="op">(</span><span class="va">fragPatchGOC</span>, whichThresh <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  quick <span class="op">=</span> <span class="st">"grainPlot"</span>, theme <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Patch grains of connectivity"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Extracting voronoi boundaries...</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figure22</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_22-1.png" alt="A scaled patch grains of connectivity (GOC) model showing the outline of Voronoi polygons in grey, and the network connections among polygons as links plotted from adjacent polygon centroids." width="288"><p class="caption">
A scaled patch grains of connectivity (GOC) model showing the outline of
Voronoi polygons in grey, and the network connections among polygons as
links plotted from adjacent polygon centroids.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level3">
<h3 id="visualization-1">Visualization<a class="anchor" aria-label="anchor" href="#visualization-1"></a>
</h3>
<div class="section level4">
<h4 id="characteristics-of-grains-of-connectivity">Characteristics of grains of connectivity<a class="anchor" aria-label="anchor" href="#characteristics-of-grains-of-connectivity"></a>
</h4>
<p>The Voronoi polygons that are complementary to a given scale or
threshold of a landscape network describe a geographic area. As polygons
are coalesced and the network is scaled, <code>grainscape</code>
collects summary statistics on several variables in the newly aggregated
areal units. These include the total area and core area of
two-dimensional nodes that fall within the boundary of the polygon, the
median link weight within the cluster, and several others.</p>
<p>Visualizing these quantities at multiple spatial scales
(<em>i.e.</em>, grains) can support a sensitivity analysis for the area
or connectivity of sub-regions in the model. For example, to assess the
availability of connected habitat or protected areas, or the risks to
the functioning of these elements.</p>
<p>The following example maps the amount of core area of patches at an
intermediate scale by varying the size of symbols plotted at the
centroids of the Voronoi polygons. Core area is defined as the area of
all patches in the polygon excluding the edges of those patches, which
consists of a one-cell wide margin. In this resistance surface node core
area appears to be correlated generally with the size of the Voronoi
polygon (<em>i.e.</em>, larger node circles appear in larger
polygons)</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Put the fourth grain of the GOC model into its own object</span></span>
<span><span class="va">fragPatchGrain4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grain.html">grain</a></span><span class="op">(</span><span class="va">fragPatchGOC</span>, whichThresh <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">figure23</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragPatchGrain4</span>, <span class="st">"vorBound"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"grey"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_fill_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragPatchGrain4</span>, <span class="st">"links"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>, xend <span class="op">=</span> <span class="va">x2</span>, yend <span class="op">=</span> <span class="va">y2</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"forestgreen"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ggGS.html">ggGS</a></span><span class="op">(</span><span class="va">fragPatchGrain4</span>, <span class="st">"nodes"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, size <span class="op">=</span> <span class="va">totalCoreArea</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"darkgreen"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Voronoi polygon metrics (core area)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Extracting voronoi boundaries...</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figure23</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_23-1.png" alt="A scaled patch grains of connectivity (GOC) model showing the outline of Voronoi polygons in grey, and the network connections among polygons. Node symbols have been scaled in proportion to the core area of patches (*i.e.*, area excluding edge) contained within the Voronoi polygon." width="288"><p class="caption">
A scaled patch grains of connectivity (GOC) model showing the outline of
Voronoi polygons in grey, and the network connections among polygons.
Node symbols have been scaled in proportion to the core area of patches
(<em>i.e.</em>, area excluding edge) contained within the Voronoi
polygon.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level3">
<h3 id="analysis-1">Analysis<a class="anchor" aria-label="anchor" href="#analysis-1"></a>
</h3>
<div class="section level4">
<h4 id="corridor-analyses-at-multiple-scales">Corridor analyses at multiple scales<a class="anchor" aria-label="anchor" href="#corridor-analyses-at-multiple-scales"></a>
</h4>
<p>Finding the shortest path through a grain of connectivity is
conceptually identical to finding the shortest path between nodes in the
minimum planar graph. The key difference is that use of a grain permits
the scaling of the network. Links between Voronoi polygons in a grain
are selected links between components or clusters on the minimum planar
graph. In a minimum planar graph we cannot find a shortest path between
nodes that are disconnected, but with a grains of connectivity model the
goal is rather to find the shortest path between these disconnected
components (represented by Voronoi polygons). The links connecting
polygons are the shortest of all those that span patches in two
components.</p>
<p>An application of grains of connectivity is to scale a corridor
analysis, effectively to find a shortest path between two locations on
the map and understand how sensitive this path may be to the scale. In
this example, we use the <code>grainscape</code> function
<code><a href="../reference/corridor.html">corridor()</a></code> to identify and plot this corridor. Because
grains of connectivity are continuously distributed across the map we do
not need to provide a focal node or patch identifier. Rather, we pass
coordinates to the function.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Set coordinates for the start and end of the corridor</span></span>
<span><span class="va">startEnd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">180</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">395</span>, <span class="fl">312</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fragCorridor3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corridor.html">corridor</a></span><span class="op">(</span><span class="va">fragPatchGOC</span>, whichThresh <span class="op">=</span> <span class="fl">3</span>, coords <span class="op">=</span> <span class="va">startEnd</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use the default plotting functionality for corridor objects</span></span>
<span><span class="va">figure24</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fragCorridor3</span>, theme <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">20</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"START"</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"X"</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">20</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"END"</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">startEnd</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"X"</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">250</span>, y <span class="op">=</span> <span class="fl">400</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"Corridor length: "</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fragCorridor3</span><span class="op">@</span><span class="va">corridorLength</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      <span class="st">" resistance units"</span></span>
<span>    <span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Corridor analysis; grain of connectivity"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Extracting Voronoi boundaries...</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figure24</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_24-1.png" alt="A corridor through a scaled patch grains of connectivity (GOC) model. The black nodes and links demonstrate the corridor between the polygons containing the start and end points (plotted in red as `X`). Green nodes and links show the remainder of the grains of connectivity network." width="288"><p class="caption">
A corridor through a scaled patch grains of connectivity (GOC) model.
The black nodes and links demonstrate the corridor between the polygons
containing the start and end points (plotted in red as <code>X</code>).
Green nodes and links show the remainder of the grains of connectivity
network.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level3">
<h3 id="modeling-1">Modeling<a class="anchor" aria-label="anchor" href="#modeling-1"></a>
</h3>
<p><strong>Distances between polygons at multiple scales</strong></p>
<p><code>grainscape</code> provides functions to automate corridor
analyses at multiple scales (grains), and for multiple points on the
map. The products are distance matrices.</p>
<p>In this example, the grain depicted in the previous corridor analysis
is used to find the pairwise shortest path distances between eight
randomly positioned points. Distances at all of the grains that are
available in the <code>GOC</code> object are produced. However, the
table that appears below shows distances for only this grain.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create eight random points on the map</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fragRes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fragRes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot these points and the grains of connectivity network</span></span>
<span><span class="va">figure25</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/grain.html">grain</a></span><span class="op">(</span><span class="va">fragPatchGOC</span>, <span class="fl">4</span><span class="op">)</span>, quick <span class="op">=</span> <span class="st">"grainPlot"</span>, theme <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">pts</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">pts</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, label <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Eight points for pairwise distances"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Extracting voronoi boundaries...</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figure25</span></span></code></pre></div>
<div class="figure">
<img src="grainscape_vignette_files/figure-html/figure_25-1.png" alt="A scaled patch grains of connectivity (GOC) model showing the outline of Voronoi polygons in grey, and the network connections among polygons as links plotted from adjacent polygon centroids. The locations of eight focal points used to calculate a pairwise distance matrix are plotted in red." width="288"><p class="caption">
A scaled patch grains of connectivity (GOC) model showing the outline of
Voronoi polygons in grey, and the network connections among polygons as
links plotted from adjacent polygon centroids. The locations of eight
focal points used to calculate a pairwise distance matrix are plotted in
red.
</p>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Find the pairwise distances between them at all grains</span></span>
<span><span class="co">## available in the GOC object created earlier</span></span>
<span><span class="va">ptsD</span> <span class="op">&lt;-</span> <span class="fu">grainscape</span><span class="fu">::</span><span class="fu"><a href="../reference/distance.html">distance</a></span><span class="op">(</span><span class="va">fragPatchGOC</span>, <span class="va">pts</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract distances for the grain of interest (4)</span></span>
<span><span class="va">ptsD2</span> <span class="op">&lt;-</span> <span class="va">ptsD</span><span class="op">$</span><span class="va">th</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">grainD</span></span>
<span></span>
<span><span class="co">## Prepare this distance matrix for printing</span></span>
<span><span class="va">ptsD2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">ptsD2</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">ptsD2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ptsD2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">ptsD2</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"Point "</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="st">" (Polygon "</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">ptsD2</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="st">")"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">ptsD2</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span></span>
<span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">ptsD2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="30%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Point 1 (Polygon 1)</td>
<td align="right">0.0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">Point 2 (Polygon 6)</td>
<td align="right">150.8</td>
<td align="right">0.0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">Point 3 (Polygon 1)</td>
<td align="right">0.0</td>
<td align="right">150.8</td>
<td align="right">0.0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">Point 4 (Polygon 1)</td>
<td align="right">0.0</td>
<td align="right">150.8</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">Point 5 (Polygon 1)</td>
<td align="right">0.0</td>
<td align="right">150.8</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">Point 6 (Polygon 1)</td>
<td align="right">0.0</td>
<td align="right">150.8</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">Point 7 (Polygon 9)</td>
<td align="right">181.4</td>
<td align="right">332.2</td>
<td align="right">181.4</td>
<td align="right">181.4</td>
<td align="right">181.4</td>
<td align="right">181.4</td>
<td align="right">0.0</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">Point 8 (Polygon 1)</td>
<td align="right">0.0</td>
<td align="right">150.8</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">181.4</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<!-- this section builds the "table of contents" figures -->
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<!-- bibliography generated automatically from citations in text -->
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Adriaensen2003" class="csl-entry">
Adriaensen, F, J P Chardon, G De Blust, E Swinnen, S Villalba, H
Gulinck, and E Matthysen. 2003. <span>“<span class="nocase">The
application of ’least-cost’ modelling as a functional landscape
model</span>.”</span> <em>Landscape and Urban Planning</em> 64 (4):
233–47. <a href="https://doi.org/10.1016/s0169-2046(02)00242-6" class="external-link">https://doi.org/10.1016/s0169-2046(02)00242-6</a>.
</div>
<div id="ref-Brooks:2003" class="csl-entry">
Brooks, C P. 2003. <span>“<span class="nocase">A scalar analysis of
landscape connectivity</span>.”</span> <em>Oikos</em> 102 (2): 433–39.
<a href="http://www.jstor.org/stable/3548048" class="external-link">http://www.jstor.org/stable/3548048</a>.
</div>
<div id="ref-Cushman2010a" class="csl-entry">
Cushman, Samuel A, and Erin L Landguth. 2010. <span>“<span class="nocase">Scale dependent inference in landscape
genetics</span>.”</span> <em>Landscape Ecology</em> 25 (6): 967–79. <a href="https://doi.org/10.1007/s10980-010-9467-0" class="external-link">https://doi.org/10.1007/s10980-010-9467-0</a>.
</div>
<div id="ref-Fall:2007eo" class="csl-entry">
Fall, Andrew, Marie-Josée Fortin, Micheline Manseau, and Dan O’Brien.
2007. <span>“<span class="nocase">Spatial Graphs: Principles and
Applications for Habitat Connectivity</span>.”</span>
<em>Ecosystems</em> 10 (3): 448–61. <a href="https://doi.org/10.1007/s10021-007-9038-7" class="external-link">https://doi.org/10.1007/s10021-007-9038-7</a>.
</div>
<div id="ref-Galpern:2013a" class="csl-entry">
Galpern, Paul, and Micheline Manseau. 2013a. <span>“<span class="nocase">Finding the functional grain: Comparing methods for
scaling resistance surfaces</span>.”</span> <em>Landscape Ecology</em>
28 (7): 1269–81. <a href="https://doi.org/10.1007/s10980-013-9873-1" class="external-link">https://doi.org/10.1007/s10980-013-9873-1</a>.
</div>
<div id="ref-Galpern:2013ec" class="csl-entry">
———. 2013b. <span>“<span class="nocase">Modelling the influence of
landscape connectivity on animal distribution: A functional grain
approach</span>.”</span> <em>Ecography</em> 36 (9): 1004–16. <a href="https://doi.org/10.1111/j.1600-0587.2012.00081.x" class="external-link">https://doi.org/10.1111/j.1600-0587.2012.00081.x</a>.
</div>
<div id="ref-Galpern:2011bc" class="csl-entry">
Galpern, Paul, Micheline Manseau, and Andrew Fall. 2011. <span>“<span class="nocase">Patch-based graphs of landscape connectivity: A guide to
construction, analysis and application for conservation</span>.”</span>
<em>Biological Conservation</em> 144 (1): 44–55. <a href="https://doi.org/10.1016/j.biocon.2010.09.002" class="external-link">https://doi.org/10.1016/j.biocon.2010.09.002</a>.
</div>
<div id="ref-Galpern:2012me" class="csl-entry">
Galpern, Paul, Micheline Manseau, and Paul J Wilson. 2012. <span>“<span class="nocase">Grains of connectivity: analysis at multiple spatial
scales in landscape genetics</span>.”</span> <em>Molecular Ecology</em>
21 (16): 3996–4009. <a href="https://doi.org/10.1111/j.1365-294X.2012.05677.x" class="external-link">https://doi.org/10.1111/j.1365-294X.2012.05677.x</a>.
</div>
<div id="ref-Pascual-Hortal:2006le" class="csl-entry">
Pascual-Hortal, Lucía, and Santiago Saura. 2006. <span>“<span class="nocase">Comparison and development of new graph-based landscape
connectivity indices: Towards the priorization of habitat patches and
corridors for conservation</span>.”</span> <em>Landscape Ecology</em> 21
(7): 959–67. <a href="https://doi.org/10.1007/s10980-006-0013-z" class="external-link">https://doi.org/10.1007/s10980-006-0013-z</a>.
</div>
<div id="ref-Urban:2001ec" class="csl-entry">
Urban, Dean, and Timothy Keitt. 2001. <span>“<span>Landscape
Connectivity: A Graph-Theoretic Perspective</span>.”</span>
<em>Ecology</em> 82 (5): 1205–18. <a href="https://doi.org/10.1890/0012-9658(2001)082%5B1205:LCAGTP%5D2.0.CO;2" class="external-link">https://doi.org/10.1890/0012-9658(2001)082[1205:LCAGTP]2.0.CO;2</a>.
</div>
<div id="ref-Zeller:2012le" class="csl-entry">
Zeller, Katherine A, Kevin McGarigal, and Andrew R Whiteley. 2012.
<span>“<span class="nocase">Estimating landscape resistance to movement:
a review</span>.”</span> <em>Landscape Ecology</em> 27 (6): 777–97. <a href="https://doi.org/10.1007/s10980-012-9737-0" class="external-link">https://doi.org/10.1007/s10980-012-9737-0</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Galpern, Sam Doctolero, Alex M Chubaty.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
